!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.FpsEmit=t()}(this,function(){"use strict";var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e,t){return e(t={exports:{}},t.exports),t.exports}var r=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r={};function i(e){return"number"==typeof e&&e!=e?r:e}function o(e){return e===r?NaN:e}t.MapLike=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._keys=[],this._values=[],n.forEach(function(e){if(!Array.isArray(e))throw Error("should be `new MapLike([ [key, value] ])`");if(2!==e.length)throw Error("should be `new MapLike([ [key, value] ])`");t.set(e[0],e[1])})}return n(e,[{key:"entries",value:function(){var e=this;return this.keys().map(function(t){var n=e.get(t);return[o(t),n]})}},{key:"keys",value:function(){return this._keys.filter(function(e){return void 0!==e}).map(o)}},{key:"values",value:function(){return this._values.slice()}},{key:"get",value:function(e){var t=this._keys.indexOf(i(e));return-1!==t?this._values[t]:void 0}},{key:"has",value:function(e){return-1!==this._keys.indexOf(i(e))}},{key:"set",value:function(e,t){var n=this._keys.indexOf(i(e));return-1!==n?this._values[n]=t:(this._keys.push(i(e)),this._values.push(t)),this}},{key:"delete",value:function(e){var t=this._keys.indexOf(i(e));return-1!==t&&(this._keys.splice(t,1),this._values.splice(t,1),!0)}},{key:"clear",value:function(){return this._keys=[],this._values=[],this}},{key:"forEach",value:function(e,t){var n=this;this.keys().forEach(function(r){e(n.get(r),r,t||n)})}},{key:"size",get:function(){return this._values.filter(function(e){return void 0!==e}).length}}]),e}()});t(r);var i=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){void 0===e&&(e={}),this.metadataMap=new r.MapLike,this.performance=e.performance||performance}return e.prototype.mark=function(e,t){if(this.performance.mark(e),t){var n=this.performance.getEntriesByName(e,"mark"),r=n[n.length-1];r&&this.metadataMap.set(r,t)}},e.prototype.getEntryMetadata=function(e){return this.metadataMap.get(e)},e.prototype.clearEntryMetadata=function(e){return this.metadataMap.delete(e)},e.prototype.clear=function(){return this.metadataMap.clear()},e}();t.PerformanceMetadataMarker=n});t(i);for(var o=i.PerformanceMetadataMarker,s=n(function(e){var t,n,r,i,o,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(e.exports=function(){return(t()-o)/1e6},n=process.hrtime,i=(t=function(){var e;return 1e9*(e=n())[0]+e[1]})(),s=1e9*process.uptime(),o=i-s):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}),a="undefined"==typeof window?e:window,u=["moz","webkit"],c="AnimationFrame",l=a["request"+c],f=a["cancel"+c]||a["cancelRequest"+c],p=0;!l&&2>p;p++)l=a[u[p]+"Request"+c],f=a[u[p]+"Cancel"+c]||a[u[p]+"CancelRequest"+c];if(!l||!f){var h=0,v=0,y=[];l=function(e){if(0===y.length){var t=s(),n=Math.max(0,1e3/60-(t-h));h=n+t,setTimeout(function(){var e=y.slice(0);y.length=0;for(var t=0;e.length>t;t++)if(!e[t].cancelled)try{e[t].callback(h)}catch(e){setTimeout(function(){throw e},0)}},Math.round(n))}return y.push({handle:++v,callback:e,cancelled:!1}),v},f=function(e){for(var t=0;y.length>t;t++)y[t].handle===e&&(y[t].cancelled=!0)}}var d=function(e){return l.call(a,e)};function m(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}d.cancel=function(){f.apply(a,arguments)},d.polyfill=function(e){e||(e=a),e.requestAnimationFrame=l,e.cancelAnimationFrame=f};var _=m;function g(e){return"function"==typeof e}function b(e){return"object"==typeof e&&null!==e}function w(e){return void 0===e}m.EventEmitter=m,m.prototype._events=void 0,m.prototype._maxListeners=void 0,m.defaultMaxListeners=10,m.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},m.prototype.emit=function(e){var t,n,r,i,o,s;if(this._events||(this._events={}),"error"===e&&(!this._events.error||b(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var a=Error('Uncaught, unspecified "error" event. ('+t+")");throw a.context=t,a}if(w(n=this._events[e]))return!1;if(g(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(b(n))for(i=Array.prototype.slice.call(arguments,1),r=(s=n.slice()).length,o=0;r>o;o++)s[o].apply(this,i);return!0},m.prototype.on=m.prototype.addListener=function(e,t){var n;if(!g(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,g(t.listener)?t.listener:t),this._events[e]?b(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,b(this._events[e])&&!this._events[e].warned&&(n=w(this._maxListeners)?m.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},m.prototype.once=function(e,t){if(!g(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},m.prototype.removeListener=function(e,t){var n,r,i,o;if(!g(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=(n=this._events[e]).length,r=-1,n===t||g(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(b(n)){for(o=i;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){r=o;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},m.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(g(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},m.prototype.listeners=function(e){return this._events&&this._events[e]?g(this._events[e])?[this._events[e]]:this._events[e].slice():[]},m.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(g(t))return 1;if(t)return t.length}return 0},m.listenerCount=function(e,t){return e.listenerCount(t)};var k=function(e){return e instanceof Buffer},x=n(function(e){e.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),E=n(function(e){try{var t=O;if("function"!=typeof t.inherits)throw"";e.exports=t.inherits}catch(t){e.exports=x}}),O=n(function(t,n){var r=/%[sdj%]/g;n.format=function(e){if(!d(e)){for(var t=[],n=0;arguments.length>n;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var i=arguments,o=i.length,a=(e+"").replace(r,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return i[n++]+"";case"%d":return+i[n++];case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return e}}),u=i[n];o>n;u=i[++n])v(u)||!g(u)?a+=" "+u:a+=" "+s(u);return a},n.deprecate=function(t,r){if(m(e.process))return function(){return n.deprecate(t,r).apply(this,arguments)};if(!0===process.noDeprecation)return t;var i=!1;return function(){if(!i){if(process.throwDeprecation)throw Error(r);process.traceDeprecation?console.trace(r):console.error(r),i=!0}return t.apply(this,arguments)}};var i,o={};function s(e,t){var r={seen:[],stylize:u};return 3>arguments.length||(r.depth=arguments[2]),4>arguments.length||(r.colors=arguments[3]),h(t)?r.showHidden=t:t&&n._extend(r,t),m(r.showHidden)&&(r.showHidden=!1),m(r.depth)&&(r.depth=2),m(r.colors)&&(r.colors=!1),m(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=a),c(r,e,r.depth)}function a(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function u(e,t){return e}function c(e,t,r){if(e.customInspect&&t&&x(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r,e);return d(i)||(i=c(e,i,r)),i}var o=function(e,t){if(m(t))return e.stylize("undefined","undefined");if(d(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(y(t))return e.stylize(""+t,"number");if(h(t))return e.stylize(""+t,"boolean");if(v(t))return e.stylize("null","null")}(e,t);if(o)return o;var s=Object.keys(t),a=function(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),w(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(t);if(0===s.length){if(x(t))return e.stylize("[Function"+(t.name?": "+t.name:"")+"]","special");if(_(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(b(t))return e.stylize(Date.prototype.toString.call(t),"date");if(w(t))return l(t)}var u,g="",k=!1,E=["{","}"];(p(t)&&(k=!0,E=["[","]"]),x(t))&&(g=" [Function"+(t.name?": "+t.name:"")+"]");return _(t)&&(g=" "+RegExp.prototype.toString.call(t)),b(t)&&(g=" "+Date.prototype.toUTCString.call(t)),w(t)&&(g=" "+l(t)),0!==s.length||k&&0!=t.length?0>r?_(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=k?function(e,t,n,r,i){for(var o=[],s=0,a=t.length;a>s;++s)M(t,s+"")?o.push(f(e,t,n,r,s+"",!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(f(e,t,n,r,i,!0))}),o}(e,t,r,a,s):s.map(function(n){return f(e,t,r,a,n,k)}),e.seen.pop(),function(e,t,n){if(e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(u,g,E)):E[0]+g+E[1]}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=e.stylize(u.set?"[Getter/Setter]":"[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),M(r,i)||(s="["+i+"]"),a||(0>e.seen.indexOf(u.value)?(a=v(n)?c(e,u.value,null):c(e,u.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),m(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function p(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function v(e){return null===e}function y(e){return"number"==typeof e}function d(e){return"string"==typeof e}function m(e){return void 0===e}function _(e){return g(e)&&"[object RegExp]"===O(e)}function g(e){return"object"==typeof e&&null!==e}function b(e){return g(e)&&"[object Date]"===O(e)}function w(e){return g(e)&&("[object Error]"===O(e)||e instanceof Error)}function x(e){return"function"==typeof e}function O(e){return Object.prototype.toString.call(e)}function j(e){return 10>e?"0"+e.toString(10):e.toString(10)}n.debuglog=function(e){if(m(i)&&(i=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!o[e])if(RegExp("\\b"+e+"\\b","i").test(i)){var t=process.pid;o[e]=function(){var r=n.format.apply(n,arguments);console.error("%s %d: %s",e,t,r)}}else o[e]=function(){};return o[e]},n.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=p,n.isBoolean=h,n.isNull=v,n.isNullOrUndefined=function(e){return null==e},n.isNumber=y,n.isString=d,n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=m,n.isRegExp=_,n.isObject=g,n.isDate=b,n.isError=w,n.isFunction=x,n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=k;var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.log=function(){var e,t;console.log("%s - %s",(t=[j((e=new Date).getHours()),j(e.getMinutes()),j(e.getSeconds())].join(":"),[e.getDate(),L[e.getMonth()],t].join(" ")),n.format.apply(n,arguments))},n.inherits=E,n._extend=function(e,t){if(!t||!g(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}),j=n(function(e){e.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),L=n(function(e){try{var t=O;if("function"!=typeof t.inherits)throw"";e.exports=t.inherits}catch(t){e.exports=j}}),M=_.EventEmitter;function S(e){if(!(this instanceof S))return new S(e);M.call(this),this.setUpdateInterval(e),this.__onRaf=this.__onRaf.bind(this),this.__fps=0,this.__total=0,this.__samples=0,this.__lastSample=this.__lastSampleBatch=performance.now(),d(this.__onRaf)}L(S,M),S.prototype.__onRaf=function(){var e=performance.now();if(this.__samples++,this.__total+=e-this.__lastSample,e-this.__lastSampleBatch>=this.__interval){var t=1e3/(this.__total/this.__samples);this.__fps!==(t=t>60?60:~~t)&&(this.__fps=t,this.emit("update",t)),this.__total=0,this.__samples=0,this.__lastSampleBatch=e}this.__lastSample=e,d(this.__onRaf)},S.prototype.setUpdateInterval=function(e){this.__interval="number"==typeof e&&e>0?e:1e3},S.prototype.get=function(){return this.__fps};var z=S;const D=new o;window.marker=D,(new z).on("update",function(e){D.mark("FPS",{details:{FPS:e}})});const A=()=>{return performance.getEntriesByType("mark").map(e=>{const t=D.getEntryMetadata(e);return{type:e.name,timeStamp:e.startTime,meta:t}})};return window.getFpsStats=A,A});
